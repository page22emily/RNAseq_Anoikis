---
title: "L2FC_heatmap"
output: html_document
date: "2023-06-15"
---


res7_adj2 <- res_7[res_7@listData[["padj"]] <= .05 & res_7@listData[["log2FoldChange"]] >= 1.5, ]
res7_adj3 <- res_7[res_7@listData[["padj"]] <= .05 & res_7@listData[["log2FoldChange"]] <= -1.5, ]

res8_adj2 <- res_8[res_8@listData[["padj"]] <= .05 & res_8@listData[["log2FoldChange"]] >= 1.5, ]
res8_adj3 <- res_8[res_8@listData[["padj"]] <= .05 & res_8@listData[["log2FoldChange"]] <= -1.5, ]

res9_adj2 <- res_9[res_9@listData[["padj"]] <= .05 & res_9@listData[["log2FoldChange"]] >= 1.5, ]
res9_adj3 <- res_9[res_9@listData[["padj"]] <= .05 & res_9@listData[["log2FoldChange"]] <= -1.5, ]
```

So now we have a data frame for each up and down regulated set in each seq data set 
Now, we want to combine these and use the information to make a heatmap. 

```{r}
sigGenes <- as.list(c(res7_adj2@rownames, res7_adj3@rownames, res8_adj2@rownames, res8_adj3@rownames, res9_adj2@rownames, res9_adj3@rownames))
```

```{r}
counts <- count[rownames(count) %in% sigGenes, ]
```

```{r}
library(data.table)
library(gtools)
counts_PO_DMSO <- counts[ , 1:3]
counts_P0_average_DMSO <- rowMeans(counts_PO_DMSO)
counts_PO_DMSO <- as.data.frame(counts_PO_DMSO)

counts_P1_DMSO <- counts[ , 4:6]
counts_P1_averages_DMSO <- rowMeans(counts_P1_DMSO)
counts_P1_DMSO <- as.data.frame(counts_P1_DMSO)

counts_P11_DMSO <- counts[ , 7:9]
counts_P11_averages_DMSO <- rowMeans(counts_P11_DMSO)
counts_P11_DMSO <- as.data.frame(counts_P11_DMSO)

counts_P0_15U <- counts[ , 10:12]
counts_P0_average_15U <- rowMeans(counts_P0_15U)
colnames(counts_P0_15U) <- c("One", "two", "three")
counts_P0_15U <- as.data.frame(counts_P0_15U)

counts_P1_15U <- counts[ , 13:15]
counts_P1_average_15U <- rowMeans(counts_P1_15U)
colnames(counts_P1_15U) <- c("One", "two", "three")
counts_P1_15U <- as.data.frame(counts_P1_15U)

counts_P11_15U <- counts[ , 16:18]
counts_P11_averages_15U <- rowMeans(counts_P11_15U)
colnames(counts_P11_15U) <- c("One", "two", "three")
counts_P11_15U <- as.data.frame(counts_P11_15U)
```

P0 15U vs DMSO
```{r}
df <- data.frame(cbind(counts_P0_average_DMSO,counts_P1_averages_DMSO,counts_P11_averages_DMSO))
```

```{r}
df_heat <- data.frame(rownames(df))
```

```{r}
library(data.table)
library(gtools)
df$P01 <- counts_P0_15U$One
df$P02 <- counts_P0_15U$two
df$P03 <- counts_P0_15U$three
df$Difference_1 <- (df$P01 - df$counts_P0_average_DMSO)
df$Difference_2 <- (df$P02 - df$counts_P0_average_DMSO)
df$Difference_3 <- (df$P03 - df$counts_P0_average_DMSO)
df$LFC_1 <-data.frame(foldchange(df$P01, df$counts_P0_average_DMSO))
df$LFC_2 <- data.frame(foldchange(df$P02, df$counts_P0_average_DMSO))
df$LFC_3 <- data.frame(foldchange(df$P03, df$counts_P0_average_DMSO))
```


```{r}
df_heat$LFCL2C_1<- data.frame(foldchange2logratio(df$LFC_1, base = 2))
df_heat$LFCL2C_2<- data.frame(foldchange2logratio(df$LFC_2, base = 2))
df_heat$LFCL2C_3<- data.frame(foldchange2logratio(df$LFC_3, base = 2))
```

```{r}
df$P11 <- counts_P1_15U$One
df$P12 <- counts_P1_15U$two
df$P13 <- counts_P1_15U$three
df$Difference_11 <- (df$P11 - df$counts_P1_average_DMSO)
df$Difference_12 <- (df$P12 - df$counts_P1_average_DMSO)
df$Difference_13 <- (df$P13 - df$counts_P1_average_DMSO)
df$LFC_11 <- foldchange(df$P11, df$counts_P1_average_DMSO)
df$LFC_12 <- foldchange(df$P12, df$counts_P1_average_DMSO)
df$LFC_13 <- foldchange(df$P13, df$counts_P1_average_DMSO)
```

#here down doesn't work 
```{r}
LFCL2C_11 <- foldchange2logratio(df$LFC_11, base = 2)
```


```{r}
df_heat$LFCL2C_12<- data.frame(foldchange2logratio(df$LFC_12, base = 2))
df_heat$LFCL2C_13<- data.frame(foldchange2logratio(df$LFC_13, base = 2))
```


```{r}
df$P111 <- counts_P11_15U$One
df$P112 <- counts_P11_15U$two
df$P113 <- counts_P11_15U$three
df$Difference_111 <- (df$P111 - df$counts_P11_average_DMSO)
df$Difference_112 <- (df$P112 - df$counts_P11_average_DMSO)
df$Difference_113 <- (df$P113 - df$counts_P11_average_DMSO)
df$LFC_111 <- foldchange(df$P111, df$counts_P11_average_DMSO)
df$LFC_112 <- foldchange(df$P112, df$counts_P11_average_DMSO)
df$LFC_113 <- foldchange(df$P113, df$counts_P11_average_DMSO)
```


```{r}
df <- data.frame(df)
df_heat$LFCL2C_111<- data.frame(foldchange2logratio(df$LFC_111, base = 2))
df_heat$LFCL2C_112<- data.frame(foldchange2logratio(df$LFC_112, base = 2))
df_heat$LFCL2C_113<- data.frame(foldchange2logratio(df$LFC_113, base = 2))
```



```{r}
df_heat[df_heat == "NaN"] <- NA
df_heat[df_heat == "Inf"] <- NA
df_heat[df_heat == "-Inf"] <- NA
df_heat_2 <- na.omit(df_heat)
```

